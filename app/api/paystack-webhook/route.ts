import { NextRequest, NextResponse } from 'next/server';import crypto from 'crypto';export async function GET(){return NextResponse.json({ok:true});}export async function POST(req:NextRequest){try{const secret=process.env.PAYSTACK_SECRET_KEY;if(!secret)return NextResponse.json({error:'Server not configured'},{status:500});const raw=await req.text();const sig=req.headers.get('x-paystack-signature')||req.headers.get('X-Paystack-Signature');if(!sig)return NextResponse.json({error:'Missing signature'},{status:401});const hash=crypto.createHmac('sha512',secret).update(raw).digest('hex');if(hash!==sig)return NextResponse.json({error:'Invalid signature'},{status:401});return NextResponse.json({ok:true});}catch(e){return NextResponse.json({error:'Webhook error'},{status:500});}}