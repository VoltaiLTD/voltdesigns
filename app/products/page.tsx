"use client";import Image from 'next/image';import Link from 'next/link';import { useMemo, useState } from 'react';import FilterBar,{type Category} from '@/components/FilterBar';import { PRODUCTS } from '@/app/data/products';const NGN=new Intl.NumberFormat('en-NG',{style:'currency',currency:'NGN',maximumFractionDigits:0});export default function ProductsPage(){const categories:Category[]=['ACP','WPC','CNC','Acoustic'];const [selectedCats,setSelectedCats]=useState<Category[]>([...categories]);const [search,setSearch]=useState('');const [sort,setSort]=useState<'price-asc'|'price-desc'|'name-asc'>('price-asc');const minPrice=0;const maxPrice=Math.max(...PRODUCTS.map(p=>p.priceNGN));const [priceRange,setPriceRange]=useState<[number,number]>([minPrice,maxPrice]);const filtered=useMemo(()=>{let list=[...PRODUCTS];if(selectedCats.length>0)list=list.filter(p=>selectedCats.includes(p.category));list=list.filter(p=>p.priceNGN>=priceRange[0]&&p.priceNGN<=priceRange[1]);if(search.trim()){const q=search.toLowerCase();list=list.filter(p=>p.name.toLowerCase().includes(q)||p.description.toLowerCase().includes(q));}if(sort==='price-asc')list.sort((a,b)=>a.priceNGN-b.priceNGN);if(sort==='price-desc')list.sort((a,b)=>b.priceNGN-a.priceNGN);if(sort==='name-asc')list.sort((a,b)=>a.name.localeCompare(b.name));return list;},[selectedCats,search,sort,priceRange]);return(<section className='section container'><h1>Products</h1><p className='text-white/70 mt-2'>ACP • WPC • CNC • Acoustic panels & doors</p><div className='mt-6'><FilterBar categories={categories} selected={selectedCats} onCategory={setSelectedCats} search={search} onSearch={setSearch} sort={sort} onSort={setSort} priceRange={priceRange} setPriceRange={setPriceRange} minPrice={minPrice} maxPrice={maxPrice} step={1000}/></div>{filtered.length===0?(<div className='text-white/60 mt-8'>No products match your filters.</div>):(<div className='grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8'>{filtered.map(p=>(<Link key={p.slug} href={`/products/${p.slug}`} className='card hover:shadow-soft transition'><div className='relative h-48 w-full mb-3 overflow-hidden rounded-xl border border-white/10'><Image src={p.image} alt={p.name} fill className='object-cover'/></div><h3 className='font-semibold'>{p.name}</h3><div className='text-white/70 text-sm mt-1'>{p.category}</div><div className='mt-2 font-semibold'>{NGN.format(p.priceNGN)} <span className='text-white/60 text-sm'>/ {p.unit}</span></div></Link>))}</div>)}</section>)}